<!DOCTYPE html><html lang="en" > <!-- The Head v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>监控系统1.5版本项目重组 | TeddyGoodman</title><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="监控系统1.5版本项目重组" /><meta name="author" content="Teddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="监控系统1.5版本项目重组" /><meta property="og:description" content="监控系统1.5版本项目重组" /><link rel="canonical" href="http://localhost:4000/posts/monitor_system_restructure/" /><meta property="og:url" content="http://localhost:4000/posts/monitor_system_restructure/" /><meta property="og:site_name" content="TeddyGoodman" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-14T14:52:45+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="监控系统1.5版本项目重组" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Teddy" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/monitor_system_restructure/"},"url":"http://localhost:4000/posts/monitor_system_restructure/","author":{"@type":"Person","name":"Teddy"},"headline":"监控系统1.5版本项目重组","dateModified":"2020-05-14T14:52:45+08:00","datePublished":"2020-05-14T14:52:45+08:00","description":"监控系统1.5版本项目重组","@type":"BlogPosting","@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> window.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous" async></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js" async></script><link rel="preload" as="style" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/syntax.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/syntax.css"><link rel="preload" as="style" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css"><link rel="preload" as="script" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js" async></script> <script src="/assets/js/dist/toc.min.js" async></script> <script src="/assets/js/dist/tooltip-loader.min.js" async></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/avatar/avatar.jpg" alt="avatar"> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">TeddyGoodman</a></div><div id="site-subtitle" class="font-italic">-- Cloud Computing Enginer --</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-3 unloaded"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-3 unloaded"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-3 unloaded"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-3 unloaded"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-3 unloaded"></i> <span>ABOUT</span> </a></li></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <!-- Switch the mode between dark and light. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightkMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightkMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/TeddyGoodman" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="javascript:window.open('mailto:' + ['teddyynagoodman','gmail.com'].join('@'))"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><!-- The Top Bar v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>监控系统1.5版本项目重组</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>监控系统1.5版本项目重组</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago" data-toggle="tooltip" data-placement="bottom" title="Thu, May 14, 2020, 2:52 PM +0800"> May 14, 2020 <i class="unloaded">2020-05-14T14:52:45+08:00</i> </span> by <span class="author"> Teddy </span></div></div><div class="post-content"><h1 id="监控系统15版本项目重组">监控系统1.5版本项目重组</h1><ul><li>采集数据处理接口添加逻辑：</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="s">"""
DES:
 监控项目数据处理入口
 
 @API
 API = {
 "/monitor_upload/snmp/": MonitorUploadAPI,
 }
 Key: 父级路由
 Value: 父级路由对应的子路由
 
 @MonitorUploadAPI
 MonitorUploadAPI = {
 "xxx": {"metric": "x.xx", "handler": metric.xx.xxx}
 }
 Key: 子路由
 Value: 监控项及处理函数
 metric: 监控项名称
 handler: 数据处理函数, 处理函数如参必须包含： metric 和 data
"""</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
</pre><td class="rouge-code"><pre>├── monitor
│   ├── api                                            │ API管理
│   │   ├── OpenFalcon_access_api                           │ 与OpenFalcon进行交互的API, 告警联系组管理, 告警模版管理, 告警名称翻译, 告警联系人组管理, 采集数据查询, 告警解除及屏蔽, 告警视图查询
│   │   ├── monitor_manage_api                        │ 对monitor采集系统进行管理的API, 承载对monitor-pg的访问, 包括监控agent增删改查, 包括监控设备增删改查, 包括监控任务增删改查
│   │   ├── metric_process_api                         │ Agent原始采集数据上报API, 包括各厂商的netconf协议下的数据上报，API以.do结尾, 包括各厂商的snmp协议下的数据上报，API以.do结尾
│   │   └── third_access_api                           │ 第三方系统管理API, 包括zabbix线路添加相关API
│   ├── conf                                           │ 配置文件, 配置项注册
│   ├── core                                           │ 监控数据处理核心
│   │   ├── OpenFalcon                                      │ 核心OpenFalcon访问模块, 告警核心配置功能，接收OpenFalcon_access_api调用
│   │   ├── handlers                                   │ 核心处理模块, 包括设备信息缓存加载功能，server服务启动前预加载数据到缓存，并定时更新，由metric数据处理单元调用
│   │   ├── metric                                     │ 监控metric数据处理模块, 原始采集数据基础处理模块，由.do数据接收API直接调用，或由vendor protocol数据处理模块基础
│   │   │   ├── vendor                                 │ 设备类采集任务的原始采集数据处理模块
│   │   │   └── wrapper                                │ Falcon数据封装模块
│   │   └── model                                      │ 数据模型, OpenFalcon数据模型, monitor数据模型
│   ├── db                                             │ db访问模块
│   ├── inventory                                      │ 监控OID，监控项管理仓库
│   ├── pkg                                            │ 功能模块管理
│   │   ├── amqp                                       │ amqp模块，包括rabbitmq生成和消费
│   │   ├── redis                                      │ redis模块，包括redis写入和读取
│   │   ├── security                                   │ 数据加密模块
│   │   └── utils                                      │ 工具组件模块
│   ├── run_agent_manager.py                           │ 运行入口：agent状态检查设备分配服务
│   ├── run_cmdb_manager.py                            │ 运行入口：CMDB设备监控同步服务
│   ├── run_server.py                                  │ 运行入口：Web Server服务
│   ├── run_service_debug.py                           │ 运行入口：所有服务debug
│   ├── run_task_scheduler.py                          │ 运行入口：其他同步服务的统一入口
│   └── service                                        │ 定时同步服务管理模块
│       ├── alarm_sync_service.py                      │ 告警翻译同步服务
│       ├── cmdb_sync_service.py                       │ CMDB设备监控同步服务
│       ├── device_distribution_service.py             │ agent状态检查设备分配服务
│       ├── device_manager_service.py                  │ 设备基础信息管理服务
│       ├── monitor_oper_service.py                    │ 监控设备同步服务，移除下线设备等
│       └── monitor_task_service.py                    │ Agent执行任务生成及同步服务
├── docs                                               │ 文档

Project Structure:
 
 
├── monitor
│   ├── __init__.py
│   ├── api
│   │   ├── __init__.py
│   │   ├── OpenFalcon_access_api                           │ 与OpenFalcon进行交互的API
│   │   │   ├── __init__.py                            │
│   │   │   ├── alarm_group_manage_api.py              │ 告警联系组管理
│   │   │   ├── alarm_manage_api.py                    │
│   │   │   ├── alarm_template_manage_api.py           │ 告警模版管理, 告警名称翻译
│   │   │   ├── alarm_user_manage_api.py               │ 告警联系人组管理
│   │   │   ├── const.py                               │
│   │   │   └── falcon_handler_api.py                  │ 采集数据查询, 告警解除及屏蔽, 告警视图查询
│   │   ├── monitor_manage_api                        │ 对monitor采集系统进行管理的API, 承载对monitor-pg的访问
│   │   │   ├── __init__.py                            │
│   │   │   ├── agent_manage_api.py                    │ 包括监控agent增删改查
│   │   │   ├── device_manage_api.py                   │ 包括监控设备增删改查
│   │   │   └── task_manage_api.py                     │ 包括监控任务增删改查
│   │   ├── metric_process_api                         │ Agent原始采集数据上报API
│   │   │   ├── __init__.py                            │
│   │   │   ├── netconf_metric_api.py                  │ 包括各厂商的netconf协议下的数据上报，API以.do结尾
│   │   │   └── snmp_metric_api.py                     │ 包括各厂商的snmp协议下的数据上报，API以.do结尾
│   │   └── third_access_api                           │ 第三方系统管理API
│   │       ├── __init__.py                            │
│   │       └── zabbix_manage_api.py                   │ 包括zabbix线路添加相关API
│   ├── conf                                           │ 配置文件
│   │   ├── __init__.py                                │ 配置项注册
│   │   ├── conf.ini                                   │ 内部云配置文件
│   │   ├── conf_debug.ini                             │ 测试环境配置文件
│   │   ├── conf_efa.ini                               │ 金融云配置文件
│   │   ├── conf_pub.ini                               │ 公有云配置文件
│   ├── core                                           │ 监控数据处理核心
│   │   ├── __init__.py                                │
│   │   ├── OpenFalcon                                      │ 核心OpenFalcon访问模块
│   │   │   ├── __init__.py                            │
│   │   │   ├── alarm_setting.py                       │ 告警核心配置功能，接收OpenFalcon_access_api调用
│   │   ├── handlers                                   │ 核心处理模块
│   │   │   ├── __init__.py                            │
│   │   │   ├── device_info_handler.py                 │ 包括设备信息缓存加载功能，server服务启动前预加载数据到缓存，并定时更新，由metric数据处理单元调用
│   │   ├── metric                                     │ 监控metric数据处理模块
│   │   │   ├── __init__.py                            │
│   │   │   ├── base.py                                │ 原始采集数据基础处理模块，由.do数据接收API直接调用，或由vendor protocol数据处理模块基础
│   │   │   ├── driver                                 │
│   │   │   │   ├── __init__.py                        │
│   │   │   │   ├── cisco_firewall.py                  │
│   │   │   │   ├── cisco_router.py                    │
│   │   │   │   ├── cisco_switch.py                    │
│   │   │   │   ├── h3c_switch.py                      │
│   │   │   │   ├── huawei_switch.py                   │
│   │   │   │   └── juniper_firewall.py                │
│   │   │   ├── protocol                               │ 协议类采集任务的原始采集数据处理模块，该任务为用户自定义任务
│   │   │   │   ├── __init__.py                        │
│   │   │   │   ├── http.py                            │ http协议任务原始采集数据处理模块
│   │   │   │   ├── ping.py                            │ ping监控任务原始采集数据处理模块
│   │   │   │   ├── process.py                         │ 进程监控任务原始采集数据处理模块
│   │   │   │   ├── snmp.py                            │ snmp协议任务原始采集数据处理模块
│   │   │   │   └── tcp.py                             │ tcp协议任务原始采集数据处理模块
│   │   │   ├── publisher.py                           │ 已完成封装的Falcon数据推送模块，包括对OpenFalcon的http上报和rabbitmq的发布
│   │   │   ├── vendor                                 │ 设备类采集任务的原始采集数据处理模块
│   │   │   │   ├── __init__.py                        │
│   │   │   │   ├── cisco.py                           │ cisco 思科原始采集数据处理模块
│   │   │   │   ├── f5.py                              │ f5 原始采集数据处理模块
│   │   │   │   ├── h3c.py                             │ h3c 华三原始采集数据处理模块
│   │   │   │   ├── hillstone.py                       │ hillstone 山石原始采集数据处理模块
│   │   │   │   ├── huawei.py                          │ huawei 华为原始采集数据处理模块
│   │   │   │   ├── infoblox.py                        │ infoblox 原始采集数据处理模块
│   │   │   │   ├── juniper.py                         │ juniper 原始采集数据处理模块
│   │   │   │   ├── nexus.py                           │ nexus 原始采集数据处理模块
│   │   │   │   └── riverbed.py                        │ riverbed 原始采集数据处理模块
│   │   │   └── wrapper                                │ Falcon数据封装模块
│   │   │       ├── __init__.py                        │
│   │   │       ├── common_metric.py                   │ 通用数据封装模块
│   │   │       ├── interface_metric.py                │ 设备子接口数据封装模块
│   │   │       ├── protocol_metric.py                 │ 协议类数据封装模块
│   │   │       └── vendor_wrapper                     │ 厂商设备数据封装模块
│   │   │           ├── __init__.py                    │
│   │   │           ├── cisco_metric.py                │ cisco 设备数据封装模块
│   │   │           ├── f5_metric.py                   │ f5 设备数据封装模块
│   │   │           ├── h3c_metric.py                  │ h3c 设备数据封装模块
│   │   │           ├── hillstone_metric.py            │ hillstone 设备数据封装模块
│   │   │           ├── huawei_metric.py               │ huawei 设备数据封装模块
│   │   │           ├── infoblox_metric.py             │ infoblox 设备数据封装模块
│   │   │           ├── juniper_metric.py              │ juniper 设备数据封装模块
│   │   │           ├── nexus_metric.py                │ nexus 设备数据封装模块
│   │   │           └── riverbed_metric.py             │ riverbed 设备数据封装模块
│   │   └── model                                      │ 数据模型
│   │       ├── __init__.py                            │
│   │       ├── OpenFalcon_data_model.py                    │ OpenFalcon数据模型
│   │       └── monitorf_data_model.py                 │ monitor数据模型
│   ├── db                                             │ db访问模块
│   │   ├── __init__.py                                │ db访问API，包括增删改查及合并
│   │   ├── api.py                                     │
│   │   ├── device_manager_dao.py                      │
│   │   ├── device_topo_dao.py                         │
│   │   ├── monitor_data_dao.py                        │
│   │   ├── monitor_oper_dao.py                        │
│   │   ├── monitor_task_dao.py                        │
│   │   └── monitor_user_view_dao.py                   │
│   ├── inventory                                      │ 监控OID，监控项管理仓库
│   │   ├── __init__.py                                │
│   │   ├── cisico_snmp.json                           │
│   │   ├── huawei_snmp.json                           │
│   │   ├── NetconfRule.py                             │
│   │   ├── SnmpRule.py                                │
│   │   └── TaskSupported.py                           │
│   ├── pkg                                            │ 功能模块管理
│   │   ├── __init__.py                                │
│   │   ├── amqp                                       │ amqp模块，包括rabbitmq生成和消费
│   │   │   ├── __init__.py                            │
│   │   │   ├── const.py                               │
│   │   │   ├── metric_publisher.py                    │
│   │   │   ├── pika_util.py                           │
│   │   ├── redis                                      │ redis模块，包括redis写入和读取
│   │   │   ├── __init__.py                            │
│   │   │   ├── redis.py                               │
│   │   ├── security                                   │ 数据加密模块
│   │   │   ├── __init__.py                            │
│   │   │   ├── key                                    │
│   │   │   │   ├── rsa.key                            │
│   │   │   │   └── rsa.pub                            │
│   │   │   └── rsa_secure.py                          │
│   │   └── utils                                      │ 工具组件模块
│   │       ├── __init__.py                            │
│   │       ├── async.py                               │
│   │       ├── daemon.py                              │
│   │       ├── date_util.py                           │
│   │       ├── encrypt_util.py                        │
│   │       ├── file_util.py                           │
│   │       ├── flow_util.py                           │
│   │       ├── global_variable.py                     │
│   │       ├── http_util.py                           │
│   │       ├── import_util.py                         │
│   │       ├── lock_util.py                           │
│   │       ├── logger.py                              │
│   │       ├── os_util.py                             │
│   │       ├── request_util.py                        │
│   │       ├── result.py                              │
│   │       ├── temp.py                                │
│   │       ├── temp.txt                               │
│   │       ├── temp2.py                               │
│   │       ├── thread_helper.py                       │
│   │       ├── time_helper.py                         │
│   ├── run_agent_manager.py                           │ 运行入口：agent状态检查设备分配服务
│   ├── run_cmdb_manager.py                            │ 运行入口：CMDB设备监控同步服务
│   ├── run_server.py                                  │ 运行入口：Web Server服务
│   ├── run_service_debug.py                           │ 运行入口：所有服务debug
│   ├── run_task_scheduler.py                          │ 运行入口：其他同步服务的统一入口
│   └── service                                        │ 定时同步服务管理模块
│       ├── __init__.py                                │
│       ├── alarm_sync_service.py                      │ 告警翻译同步服务
│       ├── cmdb_sync_service.py                       │ CMDB设备监控同步服务
│       ├── device_distribution_service.py             │ agent状态检查设备分配服务
│       ├── device_manager_service.py                  │ 设备基础信息管理服务
│       ├── monitor_oper_service.py                    │ 监控设备同步服务，移除下线设备等
│       └── monitor_task_service.py                    │ Agent执行任务生成及同步服务
├── docs                                               │
│   ├── api_docs                                       │
│   │   └── restful_api.yml                            │
│   └── README.md                                      │
├── etc                                                │
│   └── bin                                            │
│       ├── monitor-log.service                       │
│       ├── monitor-monitor.service                   │
│       ├── monitor-scheduler.service                 │
│       └── monitor-server.service                    │
├── README                                             │
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%E5%AE%9E%E8%B7%B5/'>实践</a>, <a href='/categories/%E9%9C%80%E6%B1%82%E5%AE%9E%E7%8E%B0/'>需求实现</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/monitor-system/" class="post-tag no-text-decoration" >Monitor-System</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><!-- Post sharing snippet v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=监控系统1.5版本项目重组 - TeddyGoodman&url=http://localhost:4000/posts/monitor_system_restructure/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=监控系统1.5版本项目重组 - TeddyGoodman&u=http://localhost:4000/posts/monitor_system_restructure/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=监控系统1.5版本项目重组 - TeddyGoodman&url=http://localhost:4000/posts/monitor_system_restructure/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><!-- The Pannel on right side (Desktop views) v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/go/">Go</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/sumof2019/">SumOf2019</a> <a class="post-tag" href="/tags/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">体系结构</a> <a class="post-tag" href="/tags/rabbitmq/">RabbitMQ</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/cpython/">CPython</a> <a class="post-tag" href="/tags/c%26c%2B%2B/">C&C++</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-3">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="post-extend-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <!-- Navigation buttons at the bottom of the post. v2.1 https://github.com/cotes2020/jekyll-theme-chirpy © 2020 Cotes Chung MIT License --><div class="post-navigation d-flex justify-content-between"> <a href="/posts/data-patrol/" class="btn btn-outline-primary"><p>时序数据完整性的方法巡检工具</p></a> <a href="/posts/redhat-6.5-python-dependency/" class="btn btn-outline-primary"><p>Red Hat Enterprise Linux Kernel Version 2.6.32 3.8.13 python依赖环境手动部署</p></a></div><!-- The related posts of current post. Placed in the bottom of every single post. v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-2 mb-sm-4 pb-2"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Sum-of-2019-DataInfluxPatrol-Golang/"><div class="card-body"> <span class="timeago small"> Dec 1, 2019 <i class="unloaded">2019-12-01T10:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SumOf2019 - DataInfluxPatrol</h3><div class="text-muted small"><p>DataInfluxPatrol-Golang Q: What is the method of analyzing high influx data coverage ? The implementation of high influx data coverage analyzer 1. Foundament of Architecture</p></div></div></a></div><div class="card"> <a href="/posts/Python-dynamic-map/"><div class="card-body"> <span class="timeago small"> Mar 24, 2020 <i class="unloaded">2020-03-24T10:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python实现动态生成类的http接口-monitor动态监控项</h3><div class="text-muted small"><p>项目背景 采集厂商网络硬件设备基础指标，封装OpenFalcon数据结构 参与开发人数：1人 监控系统动态监控 需要实现的目标： 数据库监控表项动态管理监控项数据处理、封装接口 新增监控项由对于处理规则处理，项目的新监控项开发只需要编写规则函数和录入监控项字段即可 1. API 处理和报文解析 项目启动，导入文件...</p></div></div></a></div><div class="card"> <a href="/posts/redis_data_sampling/"><div class="card-body"> <span class="timeago small"> May 13, 2020 <i class="unloaded">2020-05-13T14:54:35+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Data Sampling [Redis]</h3><div class="text-muted small"><p>监控覆盖率检查和数据完整性检查【2020-4】 方案一，单节点 方案二，可横向扩展集群 方案： monitor-torrent负责与redis保持连接，对应key更新当前数据value和最新的timestamp及count进行++，数据模型为 key = {endpoint} + {metric} + {tag} 注：遇到key中tag过长可以进行一定的压缩处理 value 为r...</p></div></div></a></div></div></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const el = document.querySelectorAll('#post-wrapper img'); const observer = lozad(el); observer.observe(); </script> <!-- The Footer v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/TeddyGoodman">TeddyGoodman</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://github.com" target="_blank">Github.</a></p></div></div></footer></div><!-- The Search results v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted">Trending Tags</h4><!-- The trending tags list v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2019 Cotes Chung MIT Licensed --> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/go/">Go</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/sumof2019/">SumOf2019</a> <a class="post-tag" href="/tags/%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/">体系结构</a> <a class="post-tag" href="/tags/rabbitmq/">RabbitMQ</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/cpython/">CPython</a> <a class="post-tag" href="/tags/c%26c%2B%2B/">C&C++</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <!-- Jekyll Simple Search loader v2.0 https://github.com/cotes2020/jekyll-theme-chirpy © 2017-2019 Cotes Chung MIT License --> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js" integrity="sha256-qcLR00zq6pJk4je3MLgAri8Nn+ZumUlXgTKR2H/xCY0=" crossorigin="anonymous"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://localhost:4000{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script> <script src="/assets/live2d-widget/autoload.js"></script>
